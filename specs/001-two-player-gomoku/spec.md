# Feature Specification: 双人对战五子棋游戏

**Feature Branch**: `001-two-player-gomoku`  
**Created**: 2026-01-20  
**Status**: Draft  
**Input**: User description: "开发一个双人对战的五子棋游戏。"

## Clarifications

### Session 2026-01-20

- Q: 对战方式是什么（同屏本地/在线/两者）？ → A: 同屏本地对战

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 开始对局并轮流落子直至分出胜负 (Priority: P1)

两名玩家在同一设备上开始一局新对战，轮流在棋盘上落子，系统在出现五连时判定胜者并结束对局。

**Why this priority**: 这是核心玩法，直接决定产品是否满足“可对战”的基本价值。

**Independent Test**: 创建新局后完成一段对局，通过连续落子触发胜负判定并看到结果。

**Acceptance Scenarios**:

1. **Given** 新对局开始且棋盘为空，**When** 玩家A在合法位置落子，**Then** 该位置显示玩家A棋子且轮到玩家B
2. **Given** 对局进行中且玩家A形成五连条件，**When** 玩家A完成该落子，**Then** 系统立即弹窗提示玩家A获胜并结束对局

---

### User Story 2 - 随时重新开始新局 (Priority: P2)

玩家在对局进行中或结束后，可以一键重开新局以继续对战。

**Why this priority**: 复用性强，保证多局对战的流畅体验。

**Independent Test**: 在进行中的对局中触发新局，验证棋盘和回合状态被完全重置。

**Acceptance Scenarios**:

1. **Given** 对局进行中或已结束，**When** 玩家选择“新局”，**Then** 棋盘清空、结果清除且回合重置为先手

---

### User Story 3 - 识别平局并提示结果 (Priority: P3)

当棋盘下满且无人达成五连时，系统判定为平局并给出提示。

**Why this priority**: 完整覆盖对局结果，避免无限等待或误判。

**Independent Test**: 在无胜者的情况下填满棋盘，系统给出平局提示并结束对局。

**Acceptance Scenarios**:

1. **Given** 棋盘已被落满且无人五连，**When** 最后一手落子完成，**Then** 系统判定平局并结束对局

---

### Edge Cases

- 落子位置已被占用时，系统应拒绝并给出明确提示
- 对局已结束后，系统不应允许继续落子
- 出现六连及以上时应判定为胜利
- 同一手同时形成多条五连时，仍判定当前玩家获胜

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统 MUST 支持创建双人对局并展示空棋盘
- **FR-002**: 系统 MUST 强制轮流落子并清晰显示当前轮到的玩家
- **FR-003**: 系统 MUST 仅允许在棋盘范围内的空位落子，并对非法落子给出反馈
- **FR-004**: 系统 MUST 在任意直线方向（横、竖、斜）出现连续五子或以上时判定当前玩家胜利
- **FR-005**: 系统 MUST 在判定胜负后结束对局并展示结果
- **FR-006**: 系统 MUST 在棋盘填满且无胜者时判定平局并展示结果
- **FR-007**: 系统 MUST 在对局结束后禁止继续落子
- **FR-008**: 玩家 MUST 能在任意时刻开始新局，且系统重置棋盘、回合与结果
- **FR-009**: 系统 MUST 仅提供同屏本地双人对战，不包含联网对战
- **FR-010**: 系统 MUST 在判定胜者后弹窗提示获胜方

### Key Entities *(include if feature involves data)*

- **Player**: 代表对局中的一方（先手/后手）、所用棋子颜色、当前是否轮到该玩家
- **Match**: 代表一局对战的状态（进行中/已结束）、结果（胜者/平局）、步数
- **Board**: 代表棋盘格局与各位置的占用状态
- **Move**: 代表一次落子（玩家、位置、回合顺序）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 在可用性测试中，80% 的新用户可在 60 秒内开始对局并完成至少 10 步落子
- **SC-002**: 用户落子后，棋子显示与轮次提示在 100ms 内更新可见
- **SC-005**: 对局交互在主流程中保持 60fps 目标（无明显卡顿）
- **SC-003**: 预置测试用例中所有五连（含横/竖/斜与 5+ 连）情形 100% 被正确判定
- **SC-004**: 90% 的测试用户能够正确理解胜负/平局提示并在 30 秒内开始新局

## Assumptions

- 已确认同屏本地双人对战，不包含联网对战或 AI 对手
- 默认规则为自由五子棋：连成五子或以上即胜，不考虑禁手规则
- 默认棋盘为 15×15，先手固定为玩家A（黑子）
- 不包含计时、排行、对局保存、观战等扩展功能
- 不依赖外部服务或第三方账号

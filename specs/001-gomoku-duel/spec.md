# Feature Specification: 五子棋对战

**Feature Branch**: `001-gomoku-duel`  
**Created**: 2026-01-13  
**Status**: Draft  
**Input**: User description: "开发一个五子棋应用，两个玩家进行对战。"

## Clarifications

### Session 2026-01-13

- Q: 棋盘尺寸采用哪一种？ → A: 固定 15×15
- Q: 胜负规则采用哪一种？ → A: 标准连五规则（允许超过五连也胜）
- Q: 对局结束后的落子行为如何处理？ → A: 对局结束后禁止落子，并提示结果
- Q: 是否显示当前玩家与回合状态？ → A: 显示当前玩家（黑/白）与回合状态

## 技术约束 *(mandatory)*

- 必须遵循项目宪法中规定的技术栈与语言约束
- 不得引入与宪法冲突的实现方案

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 开始对局并轮流落子 (Priority: P1)

作为两名玩家，我希望在同一设备上开始一局五子棋并交替落子，以便进行对战。

**Why this priority**: 这是最小可行对战体验的核心路径。

**Independent Test**: 打开应用后，能开始新对局并完成至少 3 步交替落子。

**Acceptance Scenarios**:

1. **Given** 新对局开始且棋盘为空，**When** 玩家在空格落子，**Then** 棋子显示在该位置且轮到另一方。
2. **Given** 棋盘某位置已有棋子，**When** 玩家点击该位置，**Then** 落子被拒绝且当前玩家不变。

---

### User Story 2 - 胜负判定与对局结束 (Priority: P2)

作为玩家，我希望系统在出现连五时立刻判定胜负并结束对局，以便明确结果。

**Why this priority**: 没有胜负判定就无法完成一局游戏。

**Independent Test**: 在同一对局中完成一方连成五子，系统立即显示获胜方并停止继续落子。

**Acceptance Scenarios**:

1. **Given** 某一方已经形成五子连线的最后一步条件，**When** 该方完成落子，**Then** 系统显示该方胜利并结束对局。
2. **Given** 棋盘已满且无任何五子连线，**When** 最后一手落子完成，**Then** 系统判定平局并结束对局。

---

### User Story 3 - 再开一局 (Priority: P3)

作为玩家，我希望在对局结束后能够快速开始新一局，以便继续对战。

**Why this priority**: 提升可玩性与连续对战体验。

**Independent Test**: 完成一局后选择“新局”，棋盘重置并开始新回合。

**Acceptance Scenarios**:

1. **Given** 对局已结束，**When** 玩家选择开始新局，**Then** 棋盘清空且从初始回合开始。

---

### Edge Cases

- 玩家在对局结束后继续尝试落子
- 棋盘已满但无胜负情况
- 一次落子形成超过五子的连线

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须支持同一设备上的两名玩家交替落子对战。
- **FR-002**: 系统必须提供固定 15×15 棋盘并清晰显示棋子位置。
- **FR-003**: 系统必须限制玩家只能在空位落子。
- **FR-004**: 系统必须在每一步落子后切换当前玩家并显示轮次。
- **FR-005**: 系统必须在任意方向（横、竖、斜）形成连续五子或以上时判定胜利（超过五连也判胜）。
- **FR-006**: 系统必须在棋盘满且无胜负时判定平局。
- **FR-007**: 系统必须提供“新局/重开”以重置对局。
- **FR-008**: 系统仅支持本地两人对战，不包含联网对战或 AI 对战。
- **FR-009**: 系统在对局结束后必须禁止继续落子并提示对局结果。
- **FR-010**: 系统必须显示当前玩家（黑/白）与回合状态。

**Assumptions & Dependencies**:
- A1: 默认黑先行。
- A2: 不涉及账号、排行、存档或跨设备同步。
- D1: 无外部服务依赖。

### Key Entities *(include if feature involves data)*

- **Game**: 一局对战的整体状态（棋盘、当前玩家、结果）。
- **Player**: 玩家身份与顺序（黑/白）。
- **Move**: 单次落子（位置、所属玩家、回合序号）。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 95% 的首次用户可在 30 秒内开始新局并完成第一手落子。
- **SC-002**: 决定胜负或平局的落子后，结果在 1 秒内呈现给玩家。
- **SC-003**: 对无效落子（占用位置/对局结束后）100% 拒绝且不改变棋盘状态。
- **SC-004**: 90% 的对局可以在无卡顿与错误提示的情况下完整结束。

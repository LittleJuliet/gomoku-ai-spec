# Feature Specification: 五子棋双人对战

**Feature Branch**: `001-gomoku-pvp`  
**Created**: 2026-01-19  
**Status**: Draft  
**Input**: User description: "开发一个五子棋双人对战游戏，两个玩家进行对战。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 完成一局对战并判定结果 (Priority: P1)

两名玩家在同一设备上轮流落子，系统校验落子是否合法、更新棋盘，并在形成连五或棋盘满时给出结果。

**Why this priority**: 这是核心价值，用户使用该功能的主要目的就是完成一局并得到胜负结果。

**Independent Test**: 从空棋盘开始，双方轮流落子直至出现胜负或和局，能够完整验证关键流程。

**Acceptance Scenarios**:

1. **Given** 空棋盘且对局未开始，**When** 玩家A落子成功，**Then** 棋盘显示该棋子且轮到玩家B行动
2. **Given** 对局进行中且玩家A已有连续四子，**When** 玩家A在同一方向落下第五码子，**Then** 系统立即宣布玩家A获胜并结束对局
3. **Given** 棋盘已满且无人形成连五，**When** 最后一子落下，**Then** 系统宣布和局并结束对局

---

### User Story 2 - 对局结束后快速开始新局 (Priority: P2)

当对局结束后，玩家可以一键重开，开始新的对战。

**Why this priority**: 对战通常会连续进行，多局玩法是常见需求。

**Independent Test**: 在任意一局结束后触发重开，能够验证是否正确清空棋盘并重置状态。

**Acceptance Scenarios**:

1. **Given** 对局已结束（胜利或和局），**When** 玩家选择“重新开始”，**Then** 棋盘清空、结果信息消失且回到开局状态

---

### Edge Cases

- 落子位置已被占用时，应拒绝该落子且不切换回合
- 对局已结束后继续落子时，应提示已结束并阻止操作
- 出现连五以上（长连）时，仍视为胜利
- 对局中断后重新开始时，必须清空历史落子与结果提示

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统 MUST 允许两名玩家开始一局本地双人对战
- **FR-002**: 系统 MUST 轮流切换当前行动玩家，并在棋盘上方显示当前玩家提示，且在合法落子后 1 秒内更新提示
- **FR-003**: 玩家 MUST 只能在空位置且轮到自己时落子
- **FR-004**: 系统 MUST 在合法落子后 1 秒内更新棋盘显示
- **FR-005**: 系统 MUST 在任一方向形成连续五子或以上时判定胜利
- **FR-006**: 系统 MUST 在胜利或和局后结束对局并阻止继续落子
- **FR-007**: 系统 MUST 在棋盘满且无胜者时判定和局
- **FR-008**: 系统 MUST 允许玩家在对局结束后重新开始并重置状态
- **FR-009**: 系统 MUST 在非法落子后 1 秒内给出错误提示且不改变回合

### Key Entities *(include if feature involves data)*

- **Game**: 对局状态、当前玩家、结果、开始玩家、落子记录
- **Player**: 玩家标识、棋子颜色
- **Move**: 落子位置、所属玩家、落子顺序
- **Board**: 棋盘大小、已占用位置

## Assumptions

- 对战为同一设备上的本地双人模式，不包含在线匹配或联网功能
- 标准棋盘大小为 15×15
- 开局默认黑子先行
- 进入对局页面即自动开始对局
- 不包含计时、悔棋、观战等扩展玩法

## Dependencies

- 无外部依赖

## Out of Scope

- 在线对战、好友匹配、排行榜等社交功能
- AI 对手或单人模式
- 复杂规则变体（禁手、先手交换等）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 95% 的测试用户能在 10 分钟内完成一局对战（胜利或和局）
- **SC-002**: 获胜落子后 1 秒内向玩家明确展示胜负结果
- **SC-003**: 重新开始操作在 2 秒内完成棋盘与状态重置
- **SC-004**: 100% 的非法落子在 1 秒内收到提示且不改变回合
